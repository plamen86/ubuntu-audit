
# SYSTEM INFORMATION:

Processor: x86_64
Machine:   x86_64
Vendor:    Ubuntu
Name:      Linux
Version:   16
Update:    04

Loading Functions

Loading:   functions/audit_system_all.sh
Loading:   functions/backup_file.sh
Loading:   functions/check_append_file.sh
Loading:   functions/check_auditctl.sh
Loading:   functions/check_ausearch.sh
Loading:   functions/check_chkconfig_service.sh
Loading:   functions/check_chsec.sh
Loading:   functions/check_chuser.sh
Loading:   functions/check_command_output.sh
Loading:   functions/check_command_value.sh
Loading:   functions/check_debian_package.sh
Loading:   functions/check_dockerd.sh
Loading:   functions/check_dscl.sh
Loading:   functions/check_file_exists.sh
Loading:   functions/check_file_perms.sh
Loading:   functions/check_file_value.sh
Loading:   functions/check_inetd_service.sh
Loading:   functions/check_initd_service.sh
Loading:   functions/check_itab.sh
Loading:   functions/check_launchctl_service.sh
Loading:   functions/check_linux_package.sh
Loading:   functions/check_lslpp.sh
Loading:   functions/check_no.sh
Loading:   functions/check_pmset.sh
Loading:   functions/check_pwpolicy.sh
Loading:   functions/check_rctcp.sh
Loading:   functions/check_rpm.sh
Loading:   functions/check_service.sh
Loading:   functions/check_subserver.sh
Loading:   functions/check_svcadm_service.sh
Loading:   functions/check_systemctl_service.sh
Loading:   functions/check_trust.sh
Loading:   functions/check_xinetd_service.sh
Loading:   functions/disable_value.sh
Loading:   functions/print_audit_info.sh
Loading:   functions/replace_file_value.sh
Loading:   functions/restore_file.sh

Loading Modules

Loading:   modules/audit_aide.sh
Loading:   modules/audit_apache.sh
Loading:   modules/audit_apparmour.sh
Loading:   modules/audit_auditd.sh
Loading:   modules/audit_autofs.sh
Loading:   modules/audit_avahi_server.sh
Loading:   modules/audit_console_login.sh
Loading:   modules/audit_core_dumps.sh
Loading:   modules/audit_cron_perms.sh
Loading:   modules/audit_cron.sh
Loading:   modules/audit_cups.sh
Loading:   modules/audit_default_umask.sh
Loading:   modules/audit_dhcp_server.sh
Loading:   modules/audit_dns_server.sh
Loading:   modules/audit_duplicate_groups.sh
Loading:   modules/audit_duplicate_users.sh
Loading:   modules/audit_email_daemons.sh
Loading:   modules/audit_filesystem_partitions.sh
Loading:   modules/audit_forward_files.sh
Loading:   modules/audit_ftp_server.sh
Loading:   modules/audit_gnome_banner.sh
Loading:   modules/audit_groups_exist.sh
Loading:   modules/audit_grub_security.sh
Loading:   modules/audit_home_ownership.sh
Loading:   modules/audit_home_perms.sh
Loading:   modules/audit_iptables.sh
Loading:   modules/audit_issue_banner.sh
Loading:   modules/audit_ldap_server.sh
Loading:   modules/audit_ldap.sh
Loading:   modules/audit_legacy.sh
Loading:   modules/audit_modprobe_conf.sh
Loading:   modules/audit_mount_nodev.sh
Loading:   modules/audit_mount_noexec.sh
Loading:   modules/audit_mount_setuid.sh
Loading:   modules/audit_netrc_files.sh
Loading:   modules/audit_nfs.sh
Loading:   modules/audit_nis_client.sh
Loading:   modules/audit_nis_server.sh
Loading:   modules/audit_ntp.sh
Loading:   modules/audit_pam_wheel.sh
Loading:   modules/audit_passwd_perms.sh
Loading:   modules/audit_password_expiry.sh
Loading:   modules/audit_password_fields.sh
Loading:   modules/audit_postfix_daemon.sh
Loading:   modules/audit_root_path.sh
Loading:   modules/audit_root_primary_group.sh
Loading:   modules/audit_rsh_client.sh
Loading:   modules/audit_rsync.sh
Loading:   modules/audit_samba.sh
Loading:   modules/audit_selinux.sh
Loading:   modules/audit_shadow_group.sh
Loading:   modules/audit_snmp.sh
Loading:   modules/audit_ssh_config.sh
Loading:   modules/audit_sticky_bit.sh
Loading:   modules/audit_suid_files.sh
Loading:   modules/audit_super_users.sh
Loading:   modules/audit_sysctl.sh
Loading:   modules/audit_syslog_server.sh
Loading:   modules/audit_system_accounting.sh
Loading:   modules/audit_system_accounts.sh
Loading:   modules/audit_system_auth.sh
Loading:   modules/audit_system_auth_unlock_time.sh
Loading:   modules/audit_talk_client.sh
Loading:   modules/audit_tcp_wrappers.sh
Loading:   modules/audit_telnet_client.sh
Loading:   modules/audit_unconfined_daemons.sh
Loading:   modules/audit_unowned_files.sh
Loading:   modules/audit_user_dotfiles.sh
Loading:   modules/audit_user_rhosts.sh
Loading:   modules/audit_writable_files.sh
Loading:   modules/audit_xinetd_server.sh
Loading:   modules/audit_xinetd.sh
Loading:   modules/audit_xwindows_server.sh
Loading:   modules/full_audit_accounting_services.sh
Loading:   modules/full_audit_disk_services.sh
Loading:   modules/full_audit_file_services.sh
Loading:   modules/full_audit_firewall_services.sh
Loading:   modules/full_audit_ftp_services.sh
Loading:   modules/full_audit_hardware_services.sh
Loading:   modules/full_audit_kernel_services.sh
Loading:   modules/full_audit_log_services.sh
Loading:   modules/full_audit_mail_services.sh
Loading:   modules/full_audit_naming_services.sh
Loading:   modules/full_audit_network_services.sh
Loading:   modules/full_audit_osx_services.sh
Loading:   modules/full_audit_other_services.sh
Loading:   modules/full_audit_password_services.sh
Loading:   modules/full_audit_power_services.sh
Loading:   modules/full_audit_print_services.sh
Loading:   modules/full_audit_routing_services.sh
Loading:   modules/full_audit_shell_services.sh
Loading:   modules/full_audit_startup_services.sh
Loading:   modules/full_audit_update_services.sh
Loading:   modules/full_audit_user_services.sh
Loading:   modules/full_audit_virtualisation_services.sh
Loading:   modules/full_audit_web_services.sh
Loading:   modules/full_audit_windows_services.sh
Loading:   modules/full_audit_x11_services.sh
Sections 1.1.1.1-8, 3.5.1-4: Modprobe Configuration
Parameter "install tipc /bin/true" is set in /etc/modprobe.conf
Warning:   Parameter "install tipc /bin/true" does not exist in /etc/modprobe.conf [1 Warnings]
[ Fix ]    echo "install tipc /bin/true" >> /etc/modprobe.conf
Parameter "install rds /bin/true" is set in /etc/modprobe.conf
Warning:   Parameter "install rds /bin/true" does not exist in /etc/modprobe.conf [2 Warnings]
[ Fix ]    echo "install rds /bin/true" >> /etc/modprobe.conf
Parameter "install sctp /bin/true" is set in /etc/modprobe.conf
Warning:   Parameter "install sctp /bin/true" does not exist in /etc/modprobe.conf [3 Warnings]
[ Fix ]    echo "install sctp /bin/true" >> /etc/modprobe.conf
Parameter "install dccp /bin/true" is set in /etc/modprobe.conf
Warning:   Parameter "install dccp /bin/true" does not exist in /etc/modprobe.conf [4 Warnings]
[ Fix ]    echo "install dccp /bin/true" >> /etc/modprobe.conf
Parameter "install udf /bin/true" is set in /etc/modprobe.conf
Warning:   Parameter "install udf /bin/true" does not exist in /etc/modprobe.conf [5 Warnings]
[ Fix ]    echo "install udf /bin/true" >> /etc/modprobe.conf
Parameter "install squashfs /bin/true" is set in /etc/modprobe.conf
Warning:   Parameter "install squashfs /bin/true" does not exist in /etc/modprobe.conf [6 Warnings]
[ Fix ]    echo "install squashfs /bin/true" >> /etc/modprobe.conf
Parameter "install hfs /bin/true" is set in /etc/modprobe.conf
Warning:   Parameter "install hfs /bin/true" does not exist in /etc/modprobe.conf [7 Warnings]
[ Fix ]    echo "install hfs /bin/true" >> /etc/modprobe.conf
Parameter "install hfsplus /bin/true" is set in /etc/modprobe.conf
Warning:   Parameter "install hfsplus /bin/true" does not exist in /etc/modprobe.conf [8 Warnings]
[ Fix ]    echo "install hfsplus /bin/true" >> /etc/modprobe.conf
Parameter "install jffs2 /bin/true" is set in /etc/modprobe.conf
Warning:   Parameter "install jffs2 /bin/true" does not exist in /etc/modprobe.conf [9 Warnings]
[ Fix ]    echo "install jffs2 /bin/true" >> /etc/modprobe.conf
Parameter "install freevxfs /bin/true" is set in /etc/modprobe.conf
Warning:   Parameter "install freevxfs /bin/true" does not exist in /etc/modprobe.conf [10 Warnings]
[ Fix ]    echo "install freevxfs /bin/true" >> /etc/modprobe.conf
Parameter "install cramfs /bin/true" is set in /etc/modprobe.conf
Warning:   Parameter "install cramfs /bin/true" does not exist in /etc/modprobe.conf [11 Warnings]
[ Fix ]    echo "install cramfs /bin/true" >> /etc/modprobe.conf
Parameter "install vfat /bin/true" is set in /etc/modprobe.conf
Warning:   Parameter "install vfat /bin/true" does not exist in /etc/modprobe.conf [12 Warnings]
[ Fix ]    echo "install vfat /bin/true" >> /etc/modprobe.conf
Sections 1.1.2,5,6,10,11,12: Filesystem /tmp is a separate partition
Secure:    Filesystem /tmp is a separate filesystem [1 Passes]
Sections 1.1.2,5,6,10,11,12: Filesystem /var is a separate partition
Secure:    Filesystem /var is a separate filesystem [2 Passes]
Sections 1.1.2,5,6,10,11,12: Filesystem /var/tmp is a separate partition
Secure:    Filesystem /var/tmp is a separate filesystem [3 Passes]
Sections 1.1.2,5,6,10,11,12: Filesystem /var/log is a separate partition
Secure:    Filesystem /var/log is a separate filesystem [4 Passes]
Sections 1.1.2,5,6,10,11,12: Filesystem /var/log/audit is a separate partition
Secure:    Filesystem /var/log/audit is a separate filesystem [5 Passes]
Sections 1.1.2,5,6,10,11,12: Filesystem /home is a separate partition
Secure:    Filesystem /home is a separate filesystem [6 Passes]
===============================
File Systems mounted with nodev
Sections 1.1.3,7,13,14,17
===============================
Warning:   Found filesystems that should be mounted nodev [13 Warnings]

[ Fix ]    cat /etc/fstab | awk '(  ~ /^ext[2,3,4]|tmpfs$/ &&  != "/" ) {  =  ",nodev" }; { printf "%-26s %-22s %-8s %-16s %-1s %-1s\n",,,,,, }' > /opt/Eniwareubuntu-audit/tmp/temp_file
[ Fix ]    cat /opt/Eniwareubuntu-audit/tmp/temp_file > /etc/fstab
[ Fix ]    rm /opt/Eniwareubuntu-audit/tmp/temp_file

Checking:  File permissions on /etc/fstab
Warning:   File /etc/fstab has incorrect permissions [14 Warnings]

[ Fix ]    chmod 0644 /etc/fstab
[ Fix ]    chown root:root /etc/fstab

==========================
Filesystems mounted with nosuid
Sections 1.1.4,8,15,18
==========================
File Systems mounted with nodev
Warning:   Found filesystems that should be mounted nodev [15 Warnings]

[ Fix ]    cat /etc/fstab | awk '(  ~ /^ext[2,3,4]|tmpfs$/ &&  != "/" ) {  =  ",nosuid" }; { printf "%-26s %-22s %-8s %-16s %-1s %-1s\n",,,,,, }' > /opt/Eniwareubuntu-audit/tmp/temp_file
[ Fix ]    cat /opt/Eniwareubuntu-audit/tmp/temp_file > /etc/fstab
[ Fix ]    rm /opt/Eniwareubuntu-audit/tmp/temp_file

Checking:  File permissions on /etc/fstab
Warning:   File /etc/fstab has incorrect permissions [16 Warnings]

[ Fix ]    chmod 0644 /etc/fstab
[ Fix ]    chown root:root /etc/fstab

==========================================
World Writable Directories and Sticky Bits
Section 1.1.20
==========================================
Warning:   Sticky bit not set on /tmp [17 Warnings]

[ Fix ]    chmod +t /tmp

Warning:   Sticky bit not set on /tmp/.X11-unix [18 Warnings]

[ Fix ]    chmod +t /tmp/.X11-unix

Warning:   Sticky bit not set on /tmp/.Test-unix [19 Warnings]

[ Fix ]    chmod +t /tmp/.Test-unix

Warning:   Sticky bit not set on /tmp/.XIM-unix [20 Warnings]

[ Fix ]    chmod +t /tmp/.XIM-unix

Warning:   Sticky bit not set on /tmp/systemd-private-0b4214d4c523446981f7f3cb48611473-colord.service-NrTdZd/tmp [21 Warnings]

[ Fix ]    chmod +t /tmp/systemd-private-0b4214d4c523446981f7f3cb48611473-colord.service-NrTdZd/tmp

Warning:   Sticky bit not set on /tmp/.font-unix [22 Warnings]

[ Fix ]    chmod +t /tmp/.font-unix

Warning:   Sticky bit not set on /tmp/systemd-private-0b4214d4c523446981f7f3cb48611473-rtkit-daemon.service-Nl6YQH/tmp [23 Warnings]

[ Fix ]    chmod +t /tmp/systemd-private-0b4214d4c523446981f7f3cb48611473-rtkit-daemon.service-Nl6YQH/tmp

Warning:   Sticky bit not set on /tmp/.ICE-unix [24 Warnings]

[ Fix ]    chmod +t /tmp/.ICE-unix

Warning:   Sticky bit not set on /var/tmp [25 Warnings]

[ Fix ]    chmod +t /var/tmp

Warning:   Sticky bit not set on /var/tmp/systemd-private-876a07bf3f334c55b15f59eb12637bfe-colord.service-Vu6uRF/tmp [26 Warnings]

[ Fix ]    chmod +t /var/tmp/systemd-private-876a07bf3f334c55b15f59eb12637bfe-colord.service-Vu6uRF/tmp

Warning:   Sticky bit not set on /var/tmp/systemd-private-0b4214d4c523446981f7f3cb48611473-colord.service-lVP2UM/tmp [27 Warnings]

[ Fix ]    chmod +t /var/tmp/systemd-private-0b4214d4c523446981f7f3cb48611473-colord.service-lVP2UM/tmp

Warning:   Sticky bit not set on /var/tmp/systemd-private-420a9f74dc9f411085dc8a19b7684285-rtkit-daemon.service-cfOKOk/tmp [28 Warnings]

[ Fix ]    chmod +t /var/tmp/systemd-private-420a9f74dc9f411085dc8a19b7684285-rtkit-daemon.service-cfOKOk/tmp

Warning:   Sticky bit not set on /var/tmp/systemd-private-0b4214d4c523446981f7f3cb48611473-rtkit-daemon.service-619hh0/tmp [29 Warnings]

[ Fix ]    chmod +t /var/tmp/systemd-private-0b4214d4c523446981f7f3cb48611473-rtkit-daemon.service-619hh0/tmp

Warning:   Sticky bit not set on /var/tmp/systemd-private-705b2e2f37214330ace2e51f8f339bb1-colord.service-LruV8m/tmp [30 Warnings]

[ Fix ]    chmod +t /var/tmp/systemd-private-705b2e2f37214330ace2e51f8f339bb1-colord.service-LruV8m/tmp

Warning:   Sticky bit not set on /var/tmp/systemd-private-876a07bf3f334c55b15f59eb12637bfe-rtkit-daemon.service-OX2KTf/tmp [31 Warnings]

[ Fix ]    chmod +t /var/tmp/systemd-private-876a07bf3f334c55b15f59eb12637bfe-rtkit-daemon.service-OX2KTf/tmp

Warning:   Sticky bit not set on /var/tmp/systemd-private-705b2e2f37214330ace2e51f8f339bb1-rtkit-daemon.service-4a7HQZ/tmp [32 Warnings]

[ Fix ]    chmod +t /var/tmp/systemd-private-705b2e2f37214330ace2e51f8f339bb1-rtkit-daemon.service-4a7HQZ/tmp

Warning:   Sticky bit not set on /var/metrics [33 Warnings]

[ Fix ]    chmod +t /var/metrics

Warning:   Sticky bit not set on /var/crash [34 Warnings]

[ Fix ]    chmod +t /var/crash

Warning:   Sticky bit not set on /run/lock [35 Warnings]

[ Fix ]    chmod +t /run/lock

Warning:   Sticky bit not set on /dev/mqueue [36 Warnings]

[ Fix ]    chmod +t /dev/mqueue

Warning:   Sticky bit not set on /dev/shm [37 Warnings]

[ Fix ]    chmod +t /dev/shm

Section 1.1.21: Automount services
Checking:  Service autofs is disabled
Sections 1.3.1-2, 1.5.4: Filesystem Integrity Checking
Parameter "0 5 * * * /usr/sbin/aide --check" is set in /etc/cron.d/aide
Warning:   Parameter "0 5 * * * /usr/sbin/aide --check" does not exist in /etc/cron.d/aide [38 Warnings]
[ Fix ]    echo "0 5 * * * /usr/sbin/aide --check" >> /etc/cron.d/aide
Checking if package is prelink uninstalled
Checking:  Package prelink is installed
Secure:    Package prelink is uninstalled [7 Passes]

[ Fix ]    echo "0 5 * * * /usr/sbin/aide --check" >> /etc/cron.d/aide

Section 1.5.1: Core Dumps
Parameter "* hard core 0" is set in /etc/security/limits.conf
Warning:   Parameter "* hard core 0" does not exist in /etc/security/limits.conf [39 Warnings]
[ Fix ]    echo "* hard core 0" >> /etc/security/limits.conf
Checking:  Value of "fs.suid_dumpable" is set to "0" in /etc/sysctl.conf
Warning:   Parameter "fs.suid_dumpable" not set to "0" in /etc/sysctl.conf [40 Warnings]

[ Fix ]    echo "fs.suid_dumpable=0" >> /etc/sysctl.conf

1.5.3, 3.1.1-2, 3.2.1-8, 3.3.1-3: Network Configuration
Checking:  Value of "fs.suid.dumpable" is set to "0" in /etc/sysctl.conf
Warning:   Parameter "fs.suid.dumpable" not set to "0" in /etc/sysctl.conf [41 Warnings]

[ Fix ]    echo "fs.suid.dumpable=0" >> /etc/sysctl.conf

Parameter "* hard core 0" is set in /etc/security/limits.conf
Warning:   Parameter "* hard core 0" does not exist in /etc/security/limits.conf [42 Warnings]
[ Fix ]    echo "* hard core 0" >> /etc/security/limits.conf
Checking:  Value of "kernel.randomize_va_space" is set to "2" in /etc/security/limits.conf
Warning:   Parameter "kernel.randomize_va_space" not set to "2" in /etc/security/limits.conf [43 Warnings]

[ Fix ]    echo "kernel.randomize_va_space=2" >> /etc/security/limits.conf

Checking:  Value of "net.ipv4.conf.default.secure_redirects" is set to "0" in /etc/security/limits.conf
Warning:   Parameter "net.ipv4.conf.default.secure_redirects" not set to "0" in /etc/security/limits.conf [44 Warnings]

[ Fix ]    echo "net.ipv4.conf.default.secure_redirects=0" >> /etc/security/limits.conf

Checking:  Value of "net.ipv4.conf.all.secure_redirects" is set to "0" in /etc/security/limits.conf
Warning:   Parameter "net.ipv4.conf.all.secure_redirects" not set to "0" in /etc/security/limits.conf [45 Warnings]

[ Fix ]    echo "net.ipv4.conf.all.secure_redirects=0" >> /etc/security/limits.conf

Checking:  Value of "net.ipv4.icmp_echo_ignore_broadcasts" is set to "1" in /etc/security/limits.conf
Warning:   Parameter "net.ipv4.icmp_echo_ignore_broadcasts" not set to "1" in /etc/security/limits.conf [46 Warnings]

[ Fix ]    echo "net.ipv4.icmp_echo_ignore_broadcasts=1" >> /etc/security/limits.conf

Checking:  Value of "net.ipv4.conf.all.accept_redirects" is set to "0" in /etc/security/limits.conf
Warning:   Parameter "net.ipv4.conf.all.accept_redirects" not set to "0" in /etc/security/limits.conf [47 Warnings]

[ Fix ]    echo "net.ipv4.conf.all.accept_redirects=0" >> /etc/security/limits.conf

Checking:  Value of "net.ipv4.conf.default.accept_redirects" is set to "0" in /etc/security/limits.conf
Warning:   Parameter "net.ipv4.conf.default.accept_redirects" not set to "0" in /etc/security/limits.conf [48 Warnings]

[ Fix ]    echo "net.ipv4.conf.default.accept_redirects=0" >> /etc/security/limits.conf

Checking:  Value of "net.ipv4.tcp_syncookies" is set to "1" in /etc/security/limits.conf
Warning:   Parameter "net.ipv4.tcp_syncookies" not set to "1" in /etc/security/limits.conf [49 Warnings]

[ Fix ]    echo "net.ipv4.tcp_syncookies=1" >> /etc/security/limits.conf

Checking:  Value of "net.ipv4.tcp_max_syn_backlog" is set to "4096" in /etc/security/limits.conf
Warning:   Parameter "net.ipv4.tcp_max_syn_backlog" not set to "4096" in /etc/security/limits.conf [50 Warnings]

[ Fix ]    echo "net.ipv4.tcp_max_syn_backlog=4096" >> /etc/security/limits.conf

Checking:  Value of "net.ipv4.conf.all.rp_filter" is set to "1" in /etc/security/limits.conf
Warning:   Parameter "net.ipv4.conf.all.rp_filter" not set to "1" in /etc/security/limits.conf [51 Warnings]

[ Fix ]    echo "net.ipv4.conf.all.rp_filter=1" >> /etc/security/limits.conf

Checking:  Value of "net.ipv4.conf.default.rp_filter" is set to "1" in /etc/security/limits.conf
Warning:   Parameter "net.ipv4.conf.default.rp_filter" not set to "1" in /etc/security/limits.conf [52 Warnings]

[ Fix ]    echo "net.ipv4.conf.default.rp_filter=1" >> /etc/security/limits.conf

Checking:  Value of "net.ipv4.conf.all.accept_source_route" is set to "0" in /etc/security/limits.conf
Warning:   Parameter "net.ipv4.conf.all.accept_source_route" not set to "0" in /etc/security/limits.conf [53 Warnings]

[ Fix ]    echo "net.ipv4.conf.all.accept_source_route=0" >> /etc/security/limits.conf

Checking:  Value of "net.ipv4.conf.default.accept_source_route" is set to "0" in /etc/security/limits.conf
Warning:   Parameter "net.ipv4.conf.default.accept_source_route" not set to "0" in /etc/security/limits.conf [54 Warnings]

[ Fix ]    echo "net.ipv4.conf.default.accept_source_route=0" >> /etc/security/limits.conf

Checking:  Value of "net.ipv4.tcp_max_orphans" is set to "256" in /etc/security/limits.conf
Warning:   Parameter "net.ipv4.tcp_max_orphans" not set to "256" in /etc/security/limits.conf [55 Warnings]

[ Fix ]    echo "net.ipv4.tcp_max_orphans=256" >> /etc/security/limits.conf

Checking:  Value of "net.ipv4.conf.all.log_martians" is set to "1" in /etc/security/limits.conf
Warning:   Parameter "net.ipv4.conf.all.log_martians" not set to "1" in /etc/security/limits.conf [56 Warnings]

[ Fix ]    echo "net.ipv4.conf.all.log_martians=1" >> /etc/security/limits.conf

Checking:  Value of "net.ipv4.ip_forward" is set to "0" in /etc/security/limits.conf
Warning:   Parameter "net.ipv4.ip_forward" not set to "0" in /etc/security/limits.conf [57 Warnings]

[ Fix ]    echo "net.ipv4.ip_forward=0" >> /etc/security/limits.conf

Checking:  Value of "net.ipv4.conf.all.send_redirects" is set to "0" in /etc/security/limits.conf
Warning:   Parameter "net.ipv4.conf.all.send_redirects" not set to "0" in /etc/security/limits.conf [58 Warnings]

[ Fix ]    echo "net.ipv4.conf.all.send_redirects=0" >> /etc/security/limits.conf

Checking:  Value of "net.ipv4.conf.default.send_redirects" is set to "0" in /etc/security/limits.conf
Warning:   Parameter "net.ipv4.conf.default.send_redirects" not set to "0" in /etc/security/limits.conf [59 Warnings]

[ Fix ]    echo "net.ipv4.conf.default.send_redirects=0" >> /etc/security/limits.conf

Checking:  Value of "net.ipv4.icmp_ignore_bogus_error_responses" is set to "1" in /etc/security/limits.conf
Warning:   Parameter "net.ipv4.icmp_ignore_bogus_error_responses" not set to "1" in /etc/security/limits.conf [60 Warnings]

[ Fix ]    echo "net.ipv4.icmp_ignore_bogus_error_responses=1" >> /etc/security/limits.conf

Checking:  Value of "net.ipv6.conf.default.accept_redirects" is set to "0" in /etc/security/limits.conf
Warning:   Parameter "net.ipv6.conf.default.accept_redirects" not set to "0" in /etc/security/limits.conf [61 Warnings]

[ Fix ]    echo "net.ipv6.conf.default.accept_redirects=0" >> /etc/security/limits.conf

Checking:  Value of "net.ipv6.conf.all.accept_ra" is set to "0" in /etc/security/limits.conf
Warning:   Parameter "net.ipv6.conf.all.accept_ra" not set to "0" in /etc/security/limits.conf [62 Warnings]

[ Fix ]    echo "net.ipv6.conf.all.accept_ra=0" >> /etc/security/limits.conf

Checking:  Value of "net.ipv6.conf.default.accept_ra" is set to "0" in /etc/security/limits.conf
Warning:   Parameter "net.ipv6.conf.default.accept_ra" not set to "0" in /etc/security/limits.conf [63 Warnings]

[ Fix ]    echo "net.ipv6.conf.default.accept_ra=0" >> /etc/security/limits.conf

Checking:  Value of "net.ipv6.route.flush" is set to "1" in /etc/security/limits.conf
Warning:   Parameter "net.ipv6.route.flush" not set to "1" in /etc/security/limits.conf [64 Warnings]

[ Fix ]    echo "net.ipv6.route.flush=1" >> /etc/security/limits.conf

Checking:  Value of "kernel.exec-shield" is set to "1" in /etc/security/limits.conf
Warning:   Parameter "kernel.exec-shield" not set to "1" in /etc/security/limits.conf [65 Warnings]

[ Fix ]    echo "kernel.exec-shield=1" >> /etc/security/limits.conf

Checking:  File permissions on /etc/security/limits.conf
Warning:   File /etc/security/limits.conf has incorrect permissions [66 Warnings]

[ Fix ]    chmod 0600 /etc/security/limits.conf
[ Fix ]    chown root:root /etc/security/limits.conf

Sections 1.6.1.1-3 => SELinux
Checking:  Value of "SELINUX" is set to "enforcing" in /etc/selinux/config
Warning:   Parameter "SELINUX" not set to "enforcing" in /etc/selinux/config [67 Warnings]

[ Fix ]    echo "SELINUX=enforcing" >> /etc/selinux/config

Checking:  Value of "SELINUXTYPE" is set to "targeted" in /etc/selinux/config
Warning:   Parameter "SELINUXTYPE" not set to "targeted" in /etc/selinux/config [68 Warnings]

[ Fix ]    echo "SELINUXTYPE=targeted" >> /etc/selinux/config

Checking:  File permissions on /etc/selinux/config
Notice:    File /etc/selinux/config does not exist
Checking:  File permissions on /boot/grub/grub.cfg
Warning:   File /boot/grub/grub.cfg has incorrect permissions [69 Warnings]

[ Fix ]    chmod 0400 /boot/grub/grub.cfg
[ Fix ]    chown root:root /boot/grub/grub.cfg

Checking:  Value of "selinux" is set to "1" in /boot/grub/grub.cfg
Warning:   Parameter "selinux" not set to "1" in /boot/grub/grub.cfg [70 Warnings]

[ Fix ]    echo "selinux=1" >> /boot/grub/grub.cfg

Checking:  Value of "enforcing" is set to "1" in /boot/grub/grub.cfg
Warning:   Parameter "enforcing" not set to "1" in /boot/grub/grub.cfg [71 Warnings]

[ Fix ]    echo "enforcing=1" >> /boot/grub/grub.cfg

Sections 1.6.2.1, 1.6.3: AppArmour
Checking if package is apparmour installed
Checking:  Package apparmour is installed
Warning:   Package apparmour is not installed [72 Warnings]

[ Fix ]    echo "* hard core 0" >> /etc/security/limits.conf

Secure:    AppArmour enabled [8 Passes]
Sections 1.7.1.1-6 => Security Warning Message
Checking:  File permissions on /etc/issue
Warning:   File /etc/issue has incorrect permissions [73 Warnings]

[ Fix ]    chmod 0644 /etc/issue
[ Fix ]    chown root:root /etc/issue

Checking:  Security message in /etc/issue
Warning:   No security message in /etc/issue [74 Warnings]
Checking:  File permissions on /etc/motd
Notice:    File /etc/motd does not exist
Checking:  Security message in /etc/motd
Warning:   No security message in /etc/motd [75 Warnings]
Checking:  File permissions on /etc/issue.net
Warning:   File /etc/issue.net has incorrect permissions [76 Warnings]

[ Fix ]    chmod 0644 /etc/issue.net
[ Fix ]    chown root:root /etc/issue.net

Checking:  Security message in /etc/issue.net
Warning:   No security message in /etc/issue.net [77 Warnings]
Legacy Inet/Init Services
Inet Services
Init Services
Section 2.2.1.1 => Network Time Protocol
Checking if package is ntp installed
Checking:  Package ntp is installed
Secure:    Package ntp is installed [9 Passes]

[ Fix ]    echo "* hard core 0" >> /etc/security/limits.conf

Checking if package is chrony installed
Checking:  Package chrony is installed
Warning:   Package chrony is not installed [78 Warnings]

[ Fix ]    echo "* hard core 0" >> /etc/security/limits.conf

Checking:  Value of "OPTIONS" is set to ""-u chrony"" in /etc/sysconfig/chronyd
Warning:   Parameter "OPTIONS" not set to ""-u chrony"" in /etc/sysconfig/chronyd [79 Warnings]

[ Fix ]    echo "OPTIONS="-u chrony"" >> /etc/sysconfig/chronyd

Checking:  Value of "ExecStart" is set to "/usr/sbin/ntpd -u ntp:ntp " in /usr/lib/systemd/system/ntpd.service
Warning:   Parameter "ExecStart" not set to "/usr/sbin/ntpd -u ntp:ntp " in /usr/lib/systemd/system/ntpd.service [80 Warnings]

[ Fix ]    echo "ExecStart=/usr/sbin/ntpd -u ntp:ntp " >> /usr/lib/systemd/system/ntpd.service

Checking:  NTP is enabled
Warning:   NTP not enabled [81 Warnings]
Parameter "restrict default kod nomodify nopeer notrap noquery" is set in /usr/lib/systemd/system/ntpd.service
Warning:   Parameter "restrict default kod nomodify nopeer notrap noquery" does not exist in /usr/lib/systemd/system/ntpd.service [82 Warnings]
[ Fix ]    echo "restrict default kod nomodify nopeer notrap noquery" >> /usr/lib/systemd/system/ntpd.service
Parameter "restrict -6 default kod nomodify nopeer notrap noquery" is set in /usr/lib/systemd/system/ntpd.service
Warning:   Parameter "restrict -6 default kod nomodify nopeer notrap noquery" does not exist in /usr/lib/systemd/system/ntpd.service [83 Warnings]
[ Fix ]    echo "restrict -6 default kod nomodify nopeer notrap noquery" >> /usr/lib/systemd/system/ntpd.service
Checking:  Value of "OPTIONS" is set to ""-u ntp:ntp -p /var/run/ntpd.pid"" in /usr/lib/systemd/system/ntpd.service
Warning:   Parameter "OPTIONS" not set to ""-u ntp:ntp -p /var/run/ntpd.pid"" in /usr/lib/systemd/system/ntpd.service [84 Warnings]

[ Fix ]    echo "OPTIONS="-u ntp:ntp -p /var/run/ntpd.pid"" >> /usr/lib/systemd/system/ntpd.service

Checking:  Value of "server" is set to "0.en.pool.ntp.org" in /etc/chrony/chrony.conf
Warning:   Parameter "server" not set to "0.en.pool.ntp.org" in /etc/chrony/chrony.conf [85 Warnings]

[ Fix ]    echo "server 0.en.pool.ntp.org" >> /etc/chrony/chrony.conf

Checking:  Value of "server" is set to "1.en.pool.ntp.org" in /etc/chrony/chrony.conf
Warning:   Parameter "server" not set to "1.en.pool.ntp.org" in /etc/chrony/chrony.conf [86 Warnings]

[ Fix ]    echo "server 1.en.pool.ntp.org" >> /etc/chrony/chrony.conf

Checking:  Value of "server" is set to "2.en.pool.ntp.org" in /etc/chrony/chrony.conf
Warning:   Parameter "server" not set to "2.en.pool.ntp.org" in /etc/chrony/chrony.conf [87 Warnings]

[ Fix ]    echo "server 2.en.pool.ntp.org" >> /etc/chrony/chrony.conf

Checking:  Value of "server" is set to "3.en.pool.ntp.org" in /etc/chrony/chrony.conf
Warning:   Parameter "server" not set to "3.en.pool.ntp.org" in /etc/chrony/chrony.conf [88 Warnings]

[ Fix ]    echo "server 3.en.pool.ntp.org" >> /etc/chrony/chrony.conf

Checking:  Value of "server" is set to "0.en.pool.ntp.org" in /etc/ntp.conf
Warning:   Parameter "server" not set to "0.en.pool.ntp.org" in /etc/ntp.conf [89 Warnings]

[ Fix ]    echo "server 0.en.pool.ntp.org" >> /etc/ntp.conf

Checking:  Value of "server" is set to "1.en.pool.ntp.org" in /etc/ntp.conf
Warning:   Parameter "server" not set to "1.en.pool.ntp.org" in /etc/ntp.conf [90 Warnings]

[ Fix ]    echo "server 1.en.pool.ntp.org" >> /etc/ntp.conf

Checking:  Value of "server" is set to "2.en.pool.ntp.org" in /etc/ntp.conf
Warning:   Parameter "server" not set to "2.en.pool.ntp.org" in /etc/ntp.conf [91 Warnings]

[ Fix ]    echo "server 2.en.pool.ntp.org" >> /etc/ntp.conf

Checking:  Value of "server" is set to "3.en.pool.ntp.org" in /etc/ntp.conf
Warning:   Parameter "server" not set to "3.en.pool.ntp.org" in /etc/ntp.conf [92 Warnings]

[ Fix ]    echo "server 3.en.pool.ntp.org" >> /etc/ntp.conf

Section 2.2.3 => Avahi Server
Checking:  Service avahi-daemon is disabled
Warning:   Service avahi-daemon is not disabled [93 Warnings]
[ Fix ]    echo "avahi-daemon,enabled" >> /home/plamen/.ubuntu-audit/08_02_2018_20_19_29/systemctl.log ; systemctl avahi-daemon disable
Section 2.2.5: DHCP Server
Checking:  Service dhcpd is disabled
Checking if package is dhcp uninstalled
Checking:  Package dhcp is installed
Secure:    Package dhcp is uninstalled [10 Passes]

[ Fix ]    echo "avahi-daemon,enabled" >> /home/plamen/.ubuntu-audit/08_02_2018_20_19_29/systemctl.log ; systemctl avahi-daemon disable

Checking:  Service slapd is disabled
Checking if package is openldap-clients uninstalled
Checking:  Package openldap-clients is installed
Secure:    Package openldap-clients is uninstalled [11 Passes]

[ Fix ]    echo "avahi-daemon,enabled" >> /home/plamen/.ubuntu-audit/08_02_2018_20_19_29/systemctl.log ; systemctl avahi-daemon disable

Section 2.2.7: NFS Services
Checking:  Service nfs is disabled
Checking:  Service nfslock is disabled
Checking:  Service portmap is disabled
Checking:  Service rpc is disabled
Checking:  Service nfs-kerner-server is disabled
Checking:  Service rpcbind is disabled
Section 2.2.8: DNS Server
Checking:  Service dnsmasq is disabled
Checking:  Service named is disabled
Checking:  Service bind9 is disabled
Section 2.2.9: FTP Daemon
Checking:  Service vsftpd is disabled
Checking if package is vsftpd uninstalled
Checking:  Package vsftpd is installed
Secure:    Package vsftpd is uninstalled [12 Passes]

[ Fix ]    echo "avahi-daemon,enabled" >> /home/plamen/.ubuntu-audit/08_02_2018_20_19_29/systemctl.log ; systemctl avahi-daemon disable

Sections 2.2.10,13 - Apache and web based services
Checking:  Service httpd is disabled
Checking if package is httpd uninstalled
Checking:  Package httpd is installed
Secure:    Package httpd is uninstalled [13 Passes]

[ Fix ]    echo "avahi-daemon,enabled" >> /home/plamen/.ubuntu-audit/08_02_2018_20_19_29/systemctl.log ; systemctl avahi-daemon disable

Checking:  Service apache is disabled
Checking if package is apache uninstalled
Checking:  Package apache is installed
Secure:    Package apache is uninstalled [14 Passes]

[ Fix ]    echo "avahi-daemon,enabled" >> /home/plamen/.ubuntu-audit/08_02_2018_20_19_29/systemctl.log ; systemctl avahi-daemon disable

Checking:  Service apache2 is disabled
Checking if package is apache2 uninstalled
Checking:  Package apache2 is installed
Secure:    Package apache2 is uninstalled [15 Passes]

[ Fix ]    echo "avahi-daemon,enabled" >> /home/plamen/.ubuntu-audit/08_02_2018_20_19_29/systemctl.log ; systemctl avahi-daemon disable

Checking:  Service tomcat5 is disabled
Checking if package is tomcat5 uninstalled
Checking:  Package tomcat5 is installed
Secure:    Package tomcat5 is uninstalled [16 Passes]

[ Fix ]    echo "avahi-daemon,enabled" >> /home/plamen/.ubuntu-audit/08_02_2018_20_19_29/systemctl.log ; systemctl avahi-daemon disable

Checking:  Service squid is disabled
Checking if package is squid uninstalled
Checking:  Package squid is installed
Warning:   Package squid is not uninstalled [94 Warnings]

[ Fix ]    echo "avahi-daemon,enabled" >> /home/plamen/.ubuntu-audit/08_02_2018_20_19_29/systemctl.log ; systemctl avahi-daemon disable

Checking:  Service prixovy is disabled
Checking if package is prixovy uninstalled
Checking:  Package prixovy is installed
Secure:    Package prixovy is uninstalled [17 Passes]

[ Fix ]    echo "avahi-daemon,enabled" >> /home/plamen/.ubuntu-audit/08_02_2018_20_19_29/systemctl.log ; systemctl avahi-daemon disable

Section 2.2.11: Mail Daemons
Checking:  Service cyrus is disabled
Checking if package is cyrus uninstalled
Checking:  Package cyrus is installed
Secure:    Package cyrus is uninstalled [18 Passes]

[ Fix ]    echo "avahi-daemon,enabled" >> /home/plamen/.ubuntu-audit/08_02_2018_20_19_29/systemctl.log ; systemctl avahi-daemon disable

Checking:  Service imapd is disabled
Checking if package is imapd uninstalled
Checking:  Package imapd is installed
Secure:    Package imapd is uninstalled [19 Passes]

[ Fix ]    echo "avahi-daemon,enabled" >> /home/plamen/.ubuntu-audit/08_02_2018_20_19_29/systemctl.log ; systemctl avahi-daemon disable

Checking:  Service qpopper is disabled
Checking if package is qpopper uninstalled
Checking:  Package qpopper is installed
Secure:    Package qpopper is uninstalled [20 Passes]

[ Fix ]    echo "avahi-daemon,enabled" >> /home/plamen/.ubuntu-audit/08_02_2018_20_19_29/systemctl.log ; systemctl avahi-daemon disable

Checking:  Service dovecot is disabled
Checking if package is dovecot uninstalled
Checking:  Package dovecot is installed
Secure:    Package dovecot is uninstalled [21 Passes]

[ Fix ]    echo "avahi-daemon,enabled" >> /home/plamen/.ubuntu-audit/08_02_2018_20_19_29/systemctl.log ; systemctl avahi-daemon disable

Sections 2.2.12: Samba Daemons
Checking:  Service smb is disabled
Checking if package is samba uninstalled
Checking:  Package samba is installed
Warning:   Package samba is not uninstalled [95 Warnings]

[ Fix ]    echo "avahi-daemon,enabled" >> /home/plamen/.ubuntu-audit/08_02_2018_20_19_29/systemctl.log ; systemctl avahi-daemon disable

Checking:  Value of "restrict anonymous" is set to "2" in /etc/samba/smb.conf
Warning:   Parameter "restrict anonymous" not set to "2" in /etc/samba/smb.conf [96 Warnings]

[ Fix ]    cat /etc/samba/smb.conf |sed "s,\[Global\],&\nrestrict anonymous=2," > /opt/Eniwareubuntu-audit/tmp/temp_file
[ Fix ]    cat /opt/Eniwareubuntu-audit/tmp/temp_file > /etc/samba/smb.conf

Checking:  Value of "guest OK" is set to "no" in /etc/samba/smb.conf
Warning:   Parameter "guest OK" not set to "no" in /etc/samba/smb.conf [97 Warnings]

[ Fix ]    cat /etc/samba/smb.conf |sed "s,\[Global\],&\nguest OK=no," > /opt/Eniwareubuntu-audit/tmp/temp_file
[ Fix ]    cat /opt/Eniwareubuntu-audit/tmp/temp_file > /etc/samba/smb.conf

Checking:  Value of "client ntlmv2 auth" is set to "yes" in /etc/samba/smb.conf
Warning:   Parameter "client ntlmv2 auth" not set to "yes" in /etc/samba/smb.conf [98 Warnings]

[ Fix ]    cat /etc/samba/smb.conf |sed "s,\[Global\],&\nclient ntlmv2 auth=yes," > /opt/Eniwareubuntu-audit/tmp/temp_file
[ Fix ]    cat /opt/Eniwareubuntu-audit/tmp/temp_file > /etc/samba/smb.conf

2.2.14: SNMP Daemons and Log Permissions
Checking:  Value of "inet_interfaces" is set to "localhost" in /etc/postfix/main.cf
Warning:   Parameter "inet_interfaces" not set to "localhost" in /etc/postfix/main.cf [99 Warnings]

[ Fix ]    echo "inet_interfaces=localhost" >> /etc/postfix/main.cf

Section 2.2.16: RSync Service
Checking:  Service rsync is disabled
Secure:    Service rsync is disabled [22 Passes]
Section 2.2.17: NIS Server Daemons
Checking:  Service nis is disabled
Section 2.3.1: NIS Client Daemons
Checking:  Service ypbind is disabled
Checking if package is ypbind uninstalled
Checking:  Package ypbind is installed
Secure:    Package ypbind is uninstalled [23 Passes]

[ Fix ]    echo "avahi-daemon,enabled" >> /home/plamen/.ubuntu-audit/08_02_2018_20_19_29/systemctl.log ; systemctl avahi-daemon disable

Checking:  Service nis is disabled
Checking if package is nis uninstalled
Checking:  Package nis is installed
Warning:   Package nis is not uninstalled [100 Warnings]

[ Fix ]    echo "avahi-daemon,enabled" >> /home/plamen/.ubuntu-audit/08_02_2018_20_19_29/systemctl.log ; systemctl avahi-daemon disable

section 2.3.2: RSH Client
Checking if package is rsh uninstalled
Checking:  Package rsh is installed
Secure:    Package rsh is uninstalled [24 Passes]

[ Fix ]    echo "avahi-daemon,enabled" >> /home/plamen/.ubuntu-audit/08_02_2018_20_19_29/systemctl.log ; systemctl avahi-daemon disable

Section 2.3: Talk Client
Checking if package is tal uninstalled
Checking:  Package tal is installed
Secure:    Package tal is uninstalled [25 Passes]

[ Fix ]    echo "avahi-daemon,enabled" >> /home/plamen/.ubuntu-audit/08_02_2018_20_19_29/systemctl.log ; systemctl avahi-daemon disable

Section 2.3.4: Telnet Client
Checking if package is telnet uninstalled
Checking:  Package telnet is installed
Warning:   Package telnet is not uninstalled [101 Warnings]

[ Fix ]    echo "avahi-daemon,enabled" >> /home/plamen/.ubuntu-audit/08_02_2018_20_19_29/systemctl.log ; systemctl avahi-daemon disable

Section 2.3.5: LDAP Client
Checking if package is openldap-clients uninstalled
Checking:  Package openldap-clients is installed
Secure:    Package openldap-clients is uninstalled [26 Passes]

[ Fix ]    echo "avahi-daemon,enabled" >> /home/plamen/.ubuntu-audit/08_02_2018_20_19_29/systemctl.log ; systemctl avahi-daemon disable

Sections 3.4.1-5: TCP Wrappers
Checking:  Value of "ALL" is set to " ALL" in /etc/hosts.deny
Warning:   Parameter "ALL" not set to " ALL" in /etc/hosts.deny [102 Warnings]

[ Fix ]    echo "ALL: ALL" >> /etc/hosts.deny

Checking:  Value of "ALL" is set to " localhost" in /etc/hosts.allow
Warning:   Parameter "ALL" not set to " localhost" in /etc/hosts.allow [103 Warnings]

[ Fix ]    echo "ALL: localhost" >> /etc/hosts.allow

Checking:  Value of "ALL" is set to " 127.0.0.1" in /etc/hosts.allow
Warning:   Parameter "ALL" not set to " 127.0.0.1" in /etc/hosts.allow [104 Warnings]

[ Fix ]    echo "ALL: 127.0.0.1" >> /etc/hosts.allow

Checking:  File permissions on /etc/hosts.deny
Warning:   File /etc/hosts.deny has incorrect permissions [105 Warnings]

[ Fix ]    chmod 0644 /etc/hosts.deny
[ Fix ]    chown root:root /etc/hosts.deny

Checking:  File permissions on /etc/hosts.allow
Warning:   File /etc/hosts.allow has incorrect permissions [106 Warnings]

[ Fix ]    chmod 0644 /etc/hosts.allow
[ Fix ]    chown root:root /etc/hosts.allow

Checking if package is tcpd installed
Checking:  Package tcpd is installed
Secure:    Package tcpd is installed [27 Passes]

[ Fix ]    echo "avahi-daemon,enabled" >> /home/plamen/.ubuntu-audit/08_02_2018_20_19_29/systemctl.log ; systemctl avahi-daemon disable

Sections 3.6.1-3: IP Tables
Checking if package is iptables installed
Checking:  Package iptables is installed
Secure:    Package iptables is installed [28 Passes]

[ Fix ]    echo "avahi-daemon,enabled" >> /home/plamen/.ubuntu-audit/08_02_2018_20_19_29/systemctl.log ; systemctl avahi-daemon disable

Checking:  Service iptables is enabled
Checking:  Service ip6tables is enabled
Warning:   All other devices allow trafic to the loopback network [107 Warnings]
Checking:  Value of "auth,user.*" is set to "/var/log/messages" in /etc/rsyslog.conf
Warning:   Parameter "auth,user.*" not set to "/var/log/messages" in /etc/rsyslog.conf [108 Warnings]

[ Fix ]    echo "auth,user.*tab/var/log/messages" >> /etc/rsyslog.conf

Checking:  Value of "kern.*" is set to "/var/log/kern.log" in /etc/rsyslog.conf
Warning:   Parameter "kern.*" not set to "/var/log/kern.log" in /etc/rsyslog.conf [109 Warnings]

[ Fix ]    echo "kern.*tab/var/log/kern.log" >> /etc/rsyslog.conf

Checking:  Value of "daemon.*" is set to "/var/log/daemon.log" in /etc/rsyslog.conf
Warning:   Parameter "daemon.*" not set to "/var/log/daemon.log" in /etc/rsyslog.conf [110 Warnings]

[ Fix ]    echo "daemon.*tab/var/log/daemon.log" >> /etc/rsyslog.conf

Checking:  Value of "syslog.*" is set to "/var/log/syslog" in /etc/rsyslog.conf
Warning:   Parameter "syslog.*" not set to "/var/log/syslog" in /etc/rsyslog.conf [111 Warnings]

[ Fix ]    echo "syslog.*tab/var/log/syslog" >> /etc/rsyslog.conf

Checking:  Value of "lpr,news,uucp,local0,local1,local2,local3,local4,local5,local6.*" is set to "/var/log/unused.log" in /etc/rsyslog.conf
Warning:   Parameter "lpr,news,uucp,local0,local1,local2,local3,local4,local5,local6.*" not set to "/var/log/unused.log" in /etc/rsyslog.conf [112 Warnings]

[ Fix ]    echo "lpr,news,uucp,local0,local1,local2,local3,local4,local5,local6.*tab/var/log/unused.log" >> /etc/rsyslog.conf

Checking:  Value of "" is set to "" in /etc/rsyslog.conf
Secure:    Parameter "" already set to "" in /etc/rsyslog.conf [29 Passes]
Checking if package is rsyslog installed
Checking:  Package rsyslog is installed
Secure:    Package rsyslog is installed [30 Passes]

[ Fix ]    echo "avahi-daemon,enabled" >> /home/plamen/.ubuntu-audit/08_02_2018_20_19_29/systemctl.log ; systemctl avahi-daemon disable

Checking:  Service rsyslog is enabled
Secure:    Service rsyslog is enabled [31 Passes]
Warning:   Rsyslog is not sending messages to a remote server [113 Warnings]

[ Fix ]    Add a server entry to /etc/rsyslog.conf, eg:
[ Fix ]    *.* @@loghost.example.com

Section 5.1.1: Cron Daemon
Checking:  Service crond is enabled
Section 5.2.1-15: SSH Server Configuration
Sections 5.3.1-4:PAM Authentication
Checking:  Value of "minlen" is set to "14" in /etc/security/pwquality.conf
Warning:   Parameter "minlen" not set to "14" in /etc/security/pwquality.conf [114 Warnings]

[ Fix ]    echo "minlen=14" >> /etc/security/pwquality.conf

Checking:  Value of "dcredit" is set to "-1" in /etc/security/pwquality.conf
Warning:   Parameter "dcredit" not set to "-1" in /etc/security/pwquality.conf [115 Warnings]

[ Fix ]    echo "dcredit=-1" >> /etc/security/pwquality.conf

Checking:  Value of "ocredit" is set to "-1" in /etc/security/pwquality.conf
Warning:   Parameter "ocredit" not set to "-1" in /etc/security/pwquality.conf [116 Warnings]

[ Fix ]    echo "ocredit=-1" >> /etc/security/pwquality.conf

Checking:  Value of "ucredit" is set to "-1" in /etc/security/pwquality.conf
Warning:   Parameter "ucredit" not set to "-1" in /etc/security/pwquality.conf [117 Warnings]

[ Fix ]    echo "ucredit=-1" >> /etc/security/pwquality.conf

Checking:  Value of "lcredit" is set to "-1" in /etc/security/pwquality.conf
Warning:   Parameter "lcredit" not set to "-1" in /etc/security/pwquality.conf [118 Warnings]

[ Fix ]    echo "lcredit=-1" >> /etc/security/pwquality.conf

Lockout time for failed password attempts enabled in /etc/pam.d/common-auth
Warning:   Lockout time for failed password attempts not enabled in /etc/pam.d/common-auth [119 Warnings]
[ Fix ]    cp /etc/pam.d/common-auth /opt/Eniwareubuntu-audit/tmp/temp_file
[ Fix ]    cat /opt/Eniwareubuntu-audit/tmp/temp_file |awk '( auth == "auth" && unlock_time == "required" && 900 == "pam_tally2.so" ) { print "auth\trequired\tpam_tally2.so onerr=fail audit silent deny=5 unlock_time=900"; print lunar.sh; next };' > /etc/pam.d/common-auth
[ Fix ]    rm /opt/Eniwareubuntu-audit/tmp/temp_file
Lockout time for failed password attempts enabled in /etc/pam.d/common-auth
Warning:   Lockout time for failed password attempts not enabled in /etc/pam.d/common-auth [120 Warnings]
[ Fix ]    cp /etc/pam.d/common-auth /opt/Eniwareubuntu-audit/tmp/temp_file
[ Fix ]    cat /opt/Eniwareubuntu-audit/tmp/temp_file |awk '( auth == "auth" && unlock_time == "required" && 900 == "pam_tally2.so" ) { print "auth\trequired\tpam_tally2.so onerr=fail audit silent deny=5 unlock_time=900"; print lunar.sh; next };' > /etc/pam.d/common-auth
[ Fix ]    rm /opt/Eniwareubuntu-audit/tmp/temp_file
Sections 5.4.1.1-4: Password Expiration Parameters on Active Accounts
Checking:  Value of "PASS_MAX_DAYS" is set to "90" in /etc/login.defs
Warning:   Parameter "PASS_MAX_DAYS" not set to "90" in /etc/login.defs [121 Warnings]

[ Fix ]    echo "PASS_MAX_DAYS=90" >> /etc/login.defs

Checking:  Value of "PASS_MIN_DAYS" is set to "7" in /etc/login.defs
Warning:   Parameter "PASS_MIN_DAYS" not set to "7" in /etc/login.defs [122 Warnings]

[ Fix ]    echo "PASS_MIN_DAYS=7" >> /etc/login.defs

Checking:  Value of "PASS_WARN_AGE" is set to "14" in /etc/login.defs
Warning:   Parameter "PASS_WARN_AGE" not set to "14" in /etc/login.defs [123 Warnings]

[ Fix ]    echo "PASS_WARN_AGE=14" >> /etc/login.defs

Checking:  Value of "PASS_MIN_LEN" is set to "9" in /etc/login.defs
Warning:   Parameter "PASS_MIN_LEN" not set to "9" in /etc/login.defs [124 Warnings]

[ Fix ]    echo "PASS_MIN_LEN=9" >> /etc/login.defs

Checking:  File permissions on /etc/login.defs
Warning:   File /etc/login.defs has incorrect permissions [125 Warnings]

[ Fix ]    chmod 0640 /etc/login.defs
[ Fix ]    chown root:root /etc/login.defs

Sections 5.4.2: System Accounts that do not have a shell
Warning:   System account daemon has an invalid shell [126 Warnings]
Warning:   System account bin has an invalid shell [127 Warnings]
Warning:   System account sys has an invalid shell [128 Warnings]
Warning:   System account games has an invalid shell [129 Warnings]
Warning:   System account man has an invalid shell [130 Warnings]
Warning:   System account lp has an invalid shell [131 Warnings]
Warning:   System account mail has an invalid shell [132 Warnings]
Warning:   System account news has an invalid shell [133 Warnings]
Warning:   System account uucp has an invalid shell [134 Warnings]
Warning:   System account proxy has an invalid shell [135 Warnings]
Warning:   System account www-data has an invalid shell [136 Warnings]
Warning:   System account backup has an invalid shell [137 Warnings]
Warning:   System account list has an invalid shell [138 Warnings]
Warning:   System account irc has an invalid shell [139 Warnings]
Warning:   System account gnats has an invalid shell [140 Warnings]
Section 5.4.3: Root Primary Group
Secure:    Primary group for root is root [32 Passes]
Section 5.4: Default umask for Users
Checking:  Value of "umask" is set to "077" in /etc/.login
Warning:   Parameter "umask" not set to "077" in /etc/.login [141 Warnings]

[ Fix ]    echo "umask 077" >> /etc/.login

Checking:  Value of "umask" is set to "077" in /etc/profile
Warning:   Parameter "umask" not set to "077" in /etc/profile [142 Warnings]

[ Fix ]    echo "umask 077" >> /etc/profile

Checking:  Value of "umask" is set to "077" in /etc/skel/.bash_profile
Warning:   Parameter "umask" not set to "077" in /etc/skel/.bash_profile [143 Warnings]

[ Fix ]    echo "umask 077" >> /etc/skel/.bash_profile

Checking:  Value of "umask" is set to "077" in /etc/csh.login
Warning:   Parameter "umask" not set to "077" in /etc/csh.login [144 Warnings]

[ Fix ]    echo "umask 077" >> /etc/csh.login

Checking:  Value of "umask" is set to "077" in /etc/csh.cshrc
Warning:   Parameter "umask" not set to "077" in /etc/csh.cshrc [145 Warnings]

[ Fix ]    echo "umask 077" >> /etc/csh.cshrc

Checking:  Value of "umask" is set to "077" in /etc/zprofile
Warning:   Parameter "umask" not set to "077" in /etc/zprofile [146 Warnings]

[ Fix ]    echo "umask 077" >> /etc/zprofile

Checking:  Value of "umask" is set to "077" in /etc/skel/.zshrc
Warning:   Parameter "umask" not set to "077" in /etc/skel/.zshrc [147 Warnings]

[ Fix ]    echo "umask 077" >> /etc/skel/.zshrc

Checking:  Value of "umask" is set to "077" in /etc/skel/.bashrc
Warning:   Parameter "umask" not set to "077" in /etc/skel/.bashrc [148 Warnings]

[ Fix ]    echo "umask 077" >> /etc/skel/.bashrc

Checking:  Value of "UMASK" is set to "077" in /etc/bashrc
Warning:   Parameter "UMASK" not set to "077" in /etc/bashrc [149 Warnings]

[ Fix ]    echo "UMASK=077" >> /etc/bashrc

Checking:  Value of "UMASK" is set to "077" in /etc/skel/.bashrc
Warning:   Parameter "UMASK" not set to "077" in /etc/skel/.bashrc [150 Warnings]

[ Fix ]    echo "UMASK=077" >> /etc/skel/.bashrc

Checking:  Value of "UMASK" is set to "077" in /etc/login.defs
Warning:   Parameter "UMASK" not set to "077" in /etc/login.defs [151 Warnings]

[ Fix ]    echo "UMASK=077" >> /etc/login.defs

Section 5.5: Root Login to System Console
Warning:   Consoles enabled on tty1 tty2 tty3 tty4 tty5 tty6 tty7 tty8 tty9 tty10 tty11 tty12 tty13 tty14 tty15 tty16 tty17 tty18 tty19 tty20 tty21 tty22 tty23 tty24 tty25 tty26 tty27 tty28 tty29 tty30 tty31 tty32 tty33 tty34 tty35 tty36 tty37 tty38 tty39 tty40 tty41 tty42 tty43 tty44 tty45 tty46 tty47 tty48 tty49 tty50 tty51 tty52 tty53 tty54 tty55 tty56 tty57 tty58 tty59 tty60 tty61 tty62 tty63 [152 Warnings]
Section 5.6: PAM SU Configuration
Warning:   Wheel group membership not required for su in /etc/pam.d/su [153 Warnings]
Sections 6.1.2-9: Group and Password File Permissions
Checking:  File permissions on /etc/passwd
Warning:   File /etc/passwd has incorrect permissions [154 Warnings]

[ Fix ]    chmod 0644 /etc/passwd
[ Fix ]    chown root:root /etc/passwd

Checking:  File permissions on /etc/group
Warning:   File /etc/group has incorrect permissions [155 Warnings]

[ Fix ]    chmod 0644 /etc/group
[ Fix ]    chown root:root /etc/group

Checking:  File permissions on /etc/shadow
Warning:   File /etc/shadow has incorrect permissions [156 Warnings]

[ Fix ]    chmod 0600 /etc/shadow
[ Fix ]    chown root:root /etc/shadow

Checking:  File permissions on /etc/gshadow
Warning:   File /etc/gshadow has incorrect permissions [157 Warnings]

[ Fix ]    chmod 0600 /etc/gshadow
[ Fix ]    chown root:root /etc/gshadow

Checking:  File permissions on /etc/group-
Warning:   File /etc/group- has incorrect permissions [158 Warnings]

[ Fix ]    chmod 0600 /etc/group-
[ Fix ]    chown root:root /etc/group-

Checking:  File permissions on /etc/passwd-
Warning:   File /etc/passwd- has incorrect permissions [159 Warnings]

[ Fix ]    chmod 0600 /etc/passwd-
[ Fix ]    chown root:root /etc/passwd-

Checking:  File permissions on /etc/shadow-
Warning:   File /etc/shadow- has incorrect permissions [160 Warnings]

[ Fix ]    chmod 0600 /etc/shadow-
[ Fix ]    chown root:root /etc/shadow-

Checking:  File permissions on /etc/gshadow-
Warning:   File /etc/gshadow- has incorrect permissions [161 Warnings]

[ Fix ]    chmod 0600 /etc/gshadow-
[ Fix ]    chown root:root /etc/gshadow-

Section(s) 6.1.11-2: Unowned Files and Directories
Sections 6.1.13-4: Set UID/GID Files
Sections 6.2.5: Accounts with UID 0
Section 6.2.6: Root PATH Environment Integrity
Secure:    No empty directory in PATH [33 Passes]
Secure:    No trailing : in PATH [34 Passes]
Secure:    Group write permission not set on directory /usr/local/sbin [35 Passes]
Secure:    Other write permission not set on directory /usr/local/sbin [36 Passes]
Secure:    Group write permission not set on directory /usr/local/bin [37 Passes]
Secure:    Other write permission not set on directory /usr/local/bin [38 Passes]
Secure:    Group write permission not set on directory /usr/sbin [39 Passes]
Secure:    Other write permission not set on directory /usr/sbin [40 Passes]
Secure:    Group write permission not set on directory /usr/bin [41 Passes]
Secure:    Other write permission not set on directory /usr/bin [42 Passes]
Secure:    Group write permission not set on directory /sbin [43 Passes]
Secure:    Other write permission not set on directory /sbin [44 Passes]
Secure:    Group write permission not set on directory /bin [45 Passes]
Secure:    Other write permission not set on directory /bin [46 Passes]
Sections 6.2.8: Home Directory Permissions
Checking:  File permissions on /home/plamen
Warning:   File /home/plamen has incorrect permissions [162 Warnings]

[ Fix ]    chmod 0700 /home/plamen

Sections 6.2.10: User Dot Files
Checking:  File permissions on /root/.bashrc
Warning:   File /root/.bashrc has incorrect permissions [163 Warnings]

[ Fix ]    chmod 0600 /root/.bashrc

Checking:  File permissions on /root/.profile
Warning:   File /root/.profile has incorrect permissions [164 Warnings]

[ Fix ]    chmod 0600 /root/.profile

Checking:  File permissions on /var/lib/lightdm/.Xauthority
Warning:   File /var/lib/lightdm/.Xauthority has incorrect permissions [165 Warnings]

[ Fix ]    chmod 0600 /var/lib/lightdm/.Xauthority

Checking:  File permissions on /home/plamen/.bash_history
Warning:   File /home/plamen/.bash_history has incorrect permissions [166 Warnings]

[ Fix ]    chmod 0600 /home/plamen/.bash_history

Checking:  File permissions on /home/plamen/.bash_logout
Warning:   File /home/plamen/.bash_logout has incorrect permissions [167 Warnings]

[ Fix ]    chmod 0600 /home/plamen/.bash_logout

Checking:  File permissions on /home/plamen/.bashrc
Warning:   File /home/plamen/.bashrc has incorrect permissions [168 Warnings]

[ Fix ]    chmod 0600 /home/plamen/.bashrc

Checking:  File permissions on /home/plamen/.dmrc
Warning:   File /home/plamen/.dmrc has incorrect permissions [169 Warnings]

[ Fix ]    chmod 0600 /home/plamen/.dmrc

Checking:  File permissions on /home/plamen/.ICEauthority
Warning:   File /home/plamen/.ICEauthority has incorrect permissions [170 Warnings]

[ Fix ]    chmod 0600 /home/plamen/.ICEauthority

Checking:  File permissions on /home/plamen/.profile
Warning:   File /home/plamen/.profile has incorrect permissions [171 Warnings]

[ Fix ]    chmod 0600 /home/plamen/.profile

Checking:  File permissions on /home/plamen/.sudo_as_admin_successful
Warning:   File /home/plamen/.sudo_as_admin_successful has incorrect permissions [172 Warnings]

[ Fix ]    chmod 0600 /home/plamen/.sudo_as_admin_successful

Checking:  File permissions on /home/plamen/.viminfo
Warning:   File /home/plamen/.viminfo has incorrect permissions [173 Warnings]

[ Fix ]    chmod 0600 /home/plamen/.viminfo

Checking:  File permissions on /home/plamen/.Xauthority
Warning:   File /home/plamen/.Xauthority has incorrect permissions [174 Warnings]

[ Fix ]    chmod 0600 /home/plamen/.Xauthority

Checking:  File permissions on /home/plamen/.xsession-errors
Warning:   File /home/plamen/.xsession-errors has incorrect permissions [175 Warnings]

[ Fix ]    chmod 0600 /home/plamen/.xsession-errors

Checking:  File permissions on /home/plamen/.xsession-errors.old
Warning:   File /home/plamen/.xsession-errors.old has incorrect permissions [176 Warnings]

[ Fix ]    chmod 0600 /home/plamen/.xsession-errors.old

Section 6.2.11: User Forward Files
Sections 6.2.12-3: User Netrc Files
Section 6.2.14: User RHosts Files
Secure:    No user rhosts files exist [47 Passes]
Sections 6.2.16,18: Duplicate Users
Sections 6.2.17,19: Duplicate Groups
Section 6.2.20: Shadow Group
Warning:   Shadow group contains members [177 Warnings]

Tests:     224
Passes:    47
Warnings:  177

